== sonar ä¿®å¤å°æŠ€å·§ --- ä¸€åŠ³æ°¸é€¸
=== èƒŒæ™¯
éšç€å®¢æˆ·å¯¹æˆ‘ä»¬çš„äº¤ä»˜è´¨é‡çš„å…³æ³¨çš„æå‡ï¼Œ è€Œsonaræ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é€”å¾„ã€‚

æ¯æ¬¡Releaseå’Œå®¢æˆ·è¿‡archä¼šè®®ï¼Œ éƒ½ä¼šé‡ç‚¹å…³æ³¨æ¯ä¸ªé¡¹ç›®sonarçš„é—®é¢˜ã€‚

å¤§å®¶åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œéƒ½ä¼šé‡åˆ°çªç„¶æœ‰ä¸ªäººæ‰¾åˆ°æˆ‘è¯´
[example]
ä½ æ˜¨å¤©äº¤çš„ä»£ç  sonaræ‰«æå‡ºäº†ä¸€ä¸ªæ–°çš„issueï¼Œéº»çƒ¦ä¿®ä¸€ä¸‹

service-bff å½“æ—¶éœ€è¦æˆ‘ä»¬teamç»´æŠ¤ã€‚æˆ‘ä¹Ÿä¿®äº†å¥½å¤šä¸ªissueã€‚

=== sonaræŠ¥çš„é—®é¢˜

TODO: è¿™é‡Œç¼ºå°‘å¼ å›¾ç‰‡ã€‚

ä¸€å…±49ä¸ªï¼Œå¤§æ¦‚å°±æ˜¯æ–¹æ³•åœ¨controlleré‡Œéœ€è¦publicã€‚

=== æŠ€å·§
å¿«é€Ÿä¿®å¤çš„æŠ€å·§æ˜¯æ²¡æœ‰çš„ï¼Œåªæœ‰è‡ªå·±ä¸€è¡Œä¸€è¡Œæ”¹ä»£ç ã€‚

todoï¼š è¿™é‡Œç¼ºå°‘å›¾ç‰‡ï¼ˆåˆ«èµ°ï¼‰

ä½†æ˜¯ï¼Œè®©è¿™ä¸ªé—®é¢˜å†ä¹Ÿä¸å‡ºç°çš„æŠ€å·§æ˜¯æœ‰çš„
[source,java]
----
@AnalyzeClasses(packages = "com.daimler.otras.controller") //<1>
public class ControllerTest {
    @ArchTest
    private final ArchRule method_in_controller_should_be_public = // <2>
            methods().that()
                    .areAnnotatedWith(GetMapping.class) // <3>
                    .or()
                    .areAnnotatedWith(PostMapping.class) // <3>
                    .or()
                    .areAnnotatedWith(PatchMapping.class) // <3>
                    .or()
                    .areAnnotatedWith(DeleteMapping.class) //<3>
                    .should()
                    .bePublic();
}
----
<1> å®šä¹‰è¦åˆ†æçš„åŒ…
<2> è§„åˆ™çš„å®šä¹‰
<3> http methodä¸Šæ³¨è§£

=== åŸç†
æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå•å…ƒæµ‹è¯•ã€‚

[source,java]
----
public class ControllerTest {
    @Test
    void method_in_controller_should_be_public() {
        JavaClasses importedClasses = new ClassFileImporter().importPackages("com.daimler.otras.controller"); // <1>
        final ArchRule rule = methods().that() // <2>
                .areAnnotatedWith(GetMapping.class)
                .or()
                .areAnnotatedWith(PostMapping.class)
                .or()
                .areAnnotatedWith(PatchMapping.class)
                .or()
                .areAnnotatedWith(DeleteMapping.class)
                .should()
                .bePublic();
        rule.check(importedClasses); //<3>
    }
}
----
<1> å®šä¹‰è¦æ‰«æçš„ç±»
<2> å®šä¹‰è§„åˆ™
<3> ç”¨å®šä¹‰çš„è§„åˆ™å»æ‰«æç±»

=== ç”¨çš„æ¡†æ¶
https://www.archunit.org/[auchUnit]

https://github.com/TNG/ArchUnit-Examples[å®˜æ–¹çš„github demo]

=== å»ºè®®
åè¾¹å¤§å®¶ä¿®sonarä¸€äº›commonå’Œç®€å•çš„é—®é¢˜ï¼Œå°è¯•å†™ä¸€ä¸ªarch unitï¼Œå»è®©sonarå†ä¹Ÿæ‰«ä¸å‡ºæ¥è¿™ä¸ªé—®é¢˜ã€‚

æå‡OTRçš„ä»£ç è´¨é‡ï¼Œéœ€è¦å¤§å®¶å‡ºä¸€ä»½åŠ›ã€‚â›½ï¸

=== é¢˜å¤–è¯ï¼šå…¶ä»–è¯­è¨€ç‰ˆæœ¬
https://archunitnet.readthedocs.io/en/latest/guide/[ArchUnit å®˜æ–¹.netç‰ˆ]

https://github.com/BenMorris/NetArchTest:[éå®˜æ–¹çš„.netç‰ˆæœ¬]

éå®˜æ–¹çš„.netç‰ˆæœ¬ï¼Œ åº”è¯¥æ˜¯.net é‡Œæœ€æ—©å‡ºç°çš„ã€‚

ä¸ªäººæ„Ÿè§‰: éå®˜æ–¹.netç‰ˆæœ¬ï¼Œè¯­æ³•æ›´å¥½ç”¨, fluent APIè®¾è®¡çš„æ›´åŠ æµç•…ï¼ˆè·Ÿå®˜æ–¹Javaç‰ˆå¯¹æ¯”ï¼Œ å®˜æ–¹.netç‰ˆè¿˜æ²¡ç”¨è¿‡ğŸ˜…ï¼‰ã€‚


